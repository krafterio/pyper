<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="pyper_overlay_menu.OverlayMenu">
        <div
            t-if="isOpened"
            t-att-class="classes"
            t-on-click="close"
            t-ref="root"
        >
            <div class="o_overlay_menu--container">
                <t t-slot="header"/>

                <input
                    t-ref="input"
                    type="text"
                    class="o_search_hidden visually-hidden w-auto"
                    data-allow-hotkeys="true"
                    t-on-input="_onInputSearch"
                    t-on-blur="_onInputBlur"
                    t-on-compositionstart="_onCompositionStart"
                />

                <!-- Current App Sections -->
                <t t-if="currentFilteredAppSections.length" t-call="pyper_overlay_menu.OverlayMenu.Menu">
                    <t t-set="apps" t-value="currentFilteredAppSections"/>
                </t>

                <t t-slot="footer"/>
            </div>
        </div>
    </t>

    <t t-name="pyper_overlay_menu.OverlayMenu.Menu">
        <div class="o_overlay_menu--menu"
             t-ref="appSubMenus"
             role="menu"
        >
            <t t-set="app_index" t-value="0" />

            <t t-foreach="apps" t-as="menu" t-key="menu.id">
                <t t-call="pyper_overlay_menu.OverlayMenu.Menu.Item">
                    <t t-set="menu" t-value="menu"/>
                    <t t-set="app_index" t-value="app_index"/>
                </t>

                <t t-set="app_index" t-value="app_index + 1" />
            </t>
        </div>
    </t>

    <t t-name="pyper_overlay_menu.OverlayMenu.Menu.Item">
        <a
            t-att-class="{'o_overlay_menu--item': true, 'o_overlay_menu--item-focused': state.focusedIndex === app_index}"
            t-att-data-menu-xmlid="menu.xmlid"
            t-att-href="('#menu_id='+menu.id+'&amp;action_id='+menu.actionID)"
            t-att-aria-selected="state.focusedIndex === app_index ? 'true' : 'false'"
            t-on-click.prevent="() => this.selectMenu(menu)"
        >
            <div class="o_overlay_menu--item-header">
                <div t-if="menu.fontIcon and !this.settings.preferWebIcon" class="o_overlay_menu--item-icon-empty" t-att-style="menu.fontIconColor ? 'color: ' + menu.fontIconColor + ';' : undefined">
                    <i t-att-class="menu.fontIcon"/>
                </div>

                <img t-elif="menu.webIconData"
                    class="o_overlay_menu--item-icon"
                    t-attf-src="data:image/jpeg;base64, {{menu.webIconData}}"
                />

                <div t-else="withIcon" class="o_overlay_menu--item-icon-empty">
                    <t t-slot="empty_icon">
                        <i class="fa fa-cube"/>
                    </t>
                </div>
            </div>

            <div  class="o_overlay_menu--item-label">
                <t t-out="menu.name"/>
            </div>
        </a>
    </t>

</templates>
