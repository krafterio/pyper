<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="signup" inherit_id="auth_signup.signup">
        <xpath expr="//button[@type='submit']" position="before">
            <script type="text/javascript" src="https://www.google.com/recaptcha/api.js"/>

            <script>
                function onSubmitSignup(token) {
                    document.querySelector(".oe_signup_form").submit();
                    console.log("onSubmitSignup, token =", token);
                }
            </script>

        </xpath>

        <xpath expr="//button[@type='submit']" position="replace">
            <button 
                type="submit" 
                class="btn btn-primary g-recaptcha" 
                t-att-data-sitekey="env['ir.config_parameter'].sudo().get_param('pyper_recaptcha_signup.site_key')"
                data-callback='onSubmitSignup' 
                data-action='submit'
            >
                Sign up
            </button>
        </xpath>


    </template>
</odoo>
