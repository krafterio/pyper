<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_smart_tag_family_tree" model="ir.ui.view">
        <field name="name">smart.tag.family.tree</field>
        <field name="model">smart.tag.family</field>
        <field name="arch" type="xml">
            <tree string="Tag Families" multi_edit="1" editable="bottom" expand="1">
                <field name="name"/>
                <field name="tag_model_name" optional="hide"/>
                <field name="is_public" widget="boolean_toggle" optional="hide"/>
                <field name="only_child" widget="boolean_toggle" optional="hide"/>
                <field name="tag_ids" widget="many2many_tags" optional="show"
                    options="{'color_field': 'color_id', 'no_quick_create': True, 'no_create': False, 'no_edit': True, 'no_open': True, }"
                    context="{'default_tag_model_name': tag_model_name, 'default_is_public': is_public, 'default_user_id': uid, 'default_family_id': id}"
                    domain="[('tag_model_name', '=', tag_model_name), ('is_public', '=', is_public), ('family_id', '=', False), 
                              '|', ('is_public', '=', True), ('user_id', '=', uid)]"
                />
                <button name="action_open_family_tag_form" 
                        type="object" 
                        title="Edit tag family" 
                        icon="fa-pencil-square-o" 
                        class="btn-secondary"
                />
            </tree>
        </field>
    </record>

    <record id="view_smart_tag_family_form" model="ir.ui.view">
        <field name="name">smart.tag.family.form</field>
        <field name="model">smart.tag.family</field>
        <field name="arch" type="xml">
            <form string="Tag Family Form">
                <sheet>
                   <group>
                        <group>
                            <field name="name"/>
                            <field name="is_public" widget="boolean_toggle"/>
                            <field name="only_child" widget="boolean_toggle"/>
                        </group>
                        <group>
                            <field name="tag_model_name" readonly="1"/>
                            <field name="user_id" />
                        </group>
                    </group>
                    <hr />
                    <group class="col-6">
                        <field name="tag_ids" widget="many2many_tags" 
                                context="{'default_tag_model_name': tag_model_name, 'default_is_public': is_public, 'default_user_id': user_id}"
                                domain="[('tag_model_name', '=', tag_model_name), ('is_public', '=', is_public), ('family_id', '=', False), '|', ('is_public', '=', True), ('user_id', '=', uid)]" 
                                placeholder="Select tags"
                                options="{'color_field': 'color_id', 'no_quick_create': True, 'no_create': False, 'no_edit': True, 'no_open': True, }"
                        />
                    </group>   
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_smart_tag_family_kanban" model="ir.ui.view">
        <field name="name">smart.tag.family.kanban</field>
        <field name="model">smart.tag.family</field>
        <field name="arch" type="xml">
            <kanban>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click p-4 rounded-1">
                            <div class="o_kanban_record_top">
                                <div class="h4">
                                    <strong>
                                        <field name="name"/>
                                    </strong>
                                </div>
                            </div>
                            <div>
                                <span class="o_kanban_label">Public : </span>
                                <field name="is_public" widget="boolean_toggle" editable="0" />
                            </div>
                            <div>
                                <span class="o_kanban_label">Only child : </span>
                                <field name="only_child" widget="boolean_toggle" editable="0" />
                            </div>
                            <t t-if="record.tag_model_name">
                                <div class="mt-2">
                                    <span class="text-muted me-3">Model owner</span>
                                    <field name="tag_model_name"/>
                                </div>
                            </t>
                            <t t-if="record.user_id">
                                <div class="mt-2">
                                    <span class="text-muted me-3">Created by</span>
                                    <field name="user_id"/>
                                </div>
                            </t>
                            <t t-if="record.tag_ids">
                                <div class="mt-2">
                                    <span class="text-muted me-3">Available tags</span>
                                    <field name="tag_ids" editable="0" widget="many2many_tags"/>
                                </div>
                            </t>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_smart_tag_family_search" model="ir.ui.view">
        <field name="name">smart.tag.family.search</field>
        <field name="model">smart.tag.family</field>
        <field name="arch" type="xml">
            <search string="Tag Families">
                <field name="name"/>
                <field name="tag_model_name"/>
                <field name="is_public"/>
                <field name="only_child"/>
                <field name="user_id"/>
                <filter string="Public" name="public_tag_families" domain="[('is_public', '=', True)]"/>
                <filter string="Private" name="private_tag_families" domain="[('is_public', '=', False)]"/>
                <filter string="Only child" name="only_child_tag_families" domain="[('only_child', '=', True)]"/>
                <filter string="Multi child" name="multi_child_tag_families" domain="[('only_child', '=', False)]"/>
                <filter string="My Tag Families" name="my_tag_families" domain="[('user_id', '=', uid)]"/>
            </search>
        </field>
    </record>
</odoo>
