<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="pyper_drawer.Drawer" owl="1">
        <div t-if="isDraggable" class="o_drawer--swiper" t-on-touchstart="_onTouchStartDrag" t-on-touchmove="_onTouchMoveDrag" t-on-touchend="_onTouchEndDrag" t-ref="swiper"/>

        <div t-att-class="classes" t-on-touchstart="_onTouchStartDrag" t-on-touchmove="_onTouchMoveDrag" t-on-touchend="_onTouchEndDrag" t-ref="root">
            <div class="o_drawer--closer btn"
                 tabindex="0"
                 aria-expanded="false"
                 t-if="props.closeAction"
                 t-on-click="close"
            >
                <i class="fa fa-fw fa-chevron-circle-left"/>
            </div>

            <t t-slot="header" t-if="displayHeader"/>

            <!-- Top Action -->
            <t t-call="pyper_drawer.Drawer.TopAction"/>

            <!-- Current App Sections -->
            <t t-call="pyper_drawer.Drawer.Menu">
                <t t-set="categories" t-value="Object.values(mainCategoryAppSections)"/>
            </t>

            <!-- Bottom Action -->
            <t t-call="pyper_drawer.Drawer.BottomAction"/>

            <div class="o_drawer--footer" t-if="displayFooter">
                <t t-call="pyper_drawer.Drawer.FooterMenu">
                    <t t-set="menus" t-value="Object.values(footerAppSections)"/>
                </t>
            </div>

            <t t-slot="footer" t-if="displayFooter"/>
        </div>

        <div class="o_drawer--obfuscator" t-on-click="close"/>
    </t>

    <t t-name="pyper_drawer.Drawer.TopAction" />

    <t t-name="pyper_drawer.Drawer.BottomAction" />

    <t t-name="pyper_drawer.Drawer.Menu" owl="1">
        <t t-set="section_index" t-value="0" />

        <div class="o_drawer--menu"
             t-ref="appSubMenus"
             role="menu"
        >
            <t t-foreach="categories" t-as="category" t-key="category.value">
                <p class="o_drawer--category-label" t-if="displayCategoryName">
                    <t t-out="category.display_name"/>
                </p>

                <hr t-elif="displayCategorySection" class="o_drawer--category-section"/>

                <t t-foreach="category.menus" t-as="menu" t-key="menu.id">
                    <t t-if="section_index lt Math.min(10, currentAppSections.length)">
                        <t t-set="section_index" t-value="section_index + 1" />
                        <t t-set="hotkey" t-value="'shift+' + (section_index % 10).toString()" />
                    </t>
                    <t t-else="">
                        <t t-set="hotkey" t-value="undefined" />
                    </t>

                    <DrawerMenuItem
                        menuXmlid="menu.xmlid"
                        menuId="menu.id"
                        menuAction="menu.actionID"
                        hotkey="hotkey"
                        withIcon="props.showRootApp"
                        iconData="menu.webIconData"
                        fontIcon="menu.font_icon"
                        fontIconColor="menu.font_icon_color"
                        label="menu.name"
                        active="menuIsSelected(menu)"
                    />
                </t>
            </t>
        </div>
    </t>

    <t t-name="pyper_drawer.Drawer.FooterMenu" owl="1">
        <t t-set="section_index" t-value="0" />

        <t t-foreach="menus" t-as="menu" t-key="menu.id">
            <t t-if="section_index lt Math.min(10, menus.length)">
                <t t-set="section_index" t-value="section_index + 1" />
                <t t-set="hotkey" t-value="'alt+shift+' + (section_index % 10).toString()" />
            </t>
            <t t-else="">
                <t t-set="hotkey" t-value="undefined" />
            </t>

            <DrawerMenuItem
                menuXmlid="menu.xmlid"
                menuId="menu.id"
                menuAction="menu.actionID"
                hotkey="hotkey"
                withIcon="props.showRootApp"
                iconData="menu.webIconData"
                fontIcon="menu.font_icon"
                fontIconColor="menu.font_icon_color"
                label="menu.name"
                active="menuIsSelected(menu)"
            />
        </t>
    </t>

</templates>
