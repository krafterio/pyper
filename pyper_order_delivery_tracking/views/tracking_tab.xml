<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_order_form_tracking_tab" model="ir.ui.view">
        <field name="name">view.order.form.tracking.tab</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='other_information']" position="after">
                <field name="several_picking_ids" invisible="1"/>
                <page string="Delivery tracking" name="delivery_tracking_tab" invisible="state != 'sale' or several_picking_ids">
                    <div class="py-4 px-5">
                        <button name="button_validate" invisible="picking_state != 'assigned'"
                                string="Validate" type="object" class="oe_highlight" groups="stock.group_stock_user"
                                data-hotkey="v"/>
                        <group class="py-3">
                            <group class="ps-0">
                                <field name="carrier_id"/>
                                <field name="carrier_tracking_ref"/>
                            </group>
                            <group>
                                <field name="picking_ref"/>
                                <field name="picking_state" widget="label_selection"
                                       options="{'classes': {'draft': 'default', 'cancel': 'danger', 'waiting': 'warning',
                                       'confirmed': 'warning', 'done': 'success'}}"/>
                            </group>
                        </group>
                        <group>

                            <field name="move_ids" readonly="picking_state == 'done'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                    <field name="product_uom_qty"/>
                                    <field name="quantity"/>
                                </tree>
                            </field>
                        </group>
                    </div>
                </page>
            </xpath>
        </field>
    </record>
</odoo>
